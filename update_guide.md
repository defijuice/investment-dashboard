# /update ìŠ¤í‚¬ ì‹¤í–‰ íë¦„ ê°€ì´ë“œ

ì´ ë¬¸ì„œëŠ” `/update` ìŠ¤í‚¬ì˜ ì‹¤ì œ ì‹¤í–‰ íë¦„ê³¼ ì£¼ìš” ì²˜ë¦¬ ë¡œì§ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

> **ì°¸ê³ **: ëª…ë ¹ì–´ ìŠ¤í™ì€ [.claude/commands/update.md](.claude/commands/update.md) ì°¸ì¡°

---

## ğŸ“‹ ëª©ì°¨

1. [ì „ì²´ ì‹¤í–‰ íë¦„](#ì „ì²´-ì‹¤í–‰-íë¦„)
2. [ë‹¨ê³„ë³„ ìƒì„¸ ì„¤ëª…](#ë‹¨ê³„ë³„-ìƒì„¸-ì„¤ëª…)
3. [ì£¼ìš” ì²˜ë¦¬ ë¡œì§](#ì£¼ìš”-ì²˜ë¦¬-ë¡œì§)
4. [ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬](#ì˜ˆì™¸-ìƒí™©-ì²˜ë¦¬)
5. [ì‹¤ì œ ì²˜ë¦¬ ì˜ˆì‹œ](#ì‹¤ì œ-ì²˜ë¦¬-ì˜ˆì‹œ)

---

## ì „ì²´ ì‹¤í–‰ íë¦„

```mermaid
graph TD
    A[íŒŒì¼ë²ˆí˜¸ ì…ë ¥] --> B[1. íŒŒì¼ ì‹œíŠ¸ ì¡°íšŒ]
    B --> C{íŒŒì¼ ì¡´ì¬?}
    C -->|ì—†ìŒ| D[ë‹¤ìš´ë¡œë“œ í´ë”ì—ì„œ ê²€ìƒ‰]
    C -->|ìˆìŒ| E[íŒŒì¼ ì •ë³´ í™•ì¸]
    D --> E
    E --> F{ì²˜ë¦¬ìƒíƒœ ì™„ë£Œ?}
    F -->|ì™„ë£Œ| G[ì²˜ë¦¬ ì¢…ë£Œ]
    F -->|ë¯¸ì²˜ë¦¬| H[2. ìŒ íŒŒì¼ ê²€ìƒ‰]
    H --> I{íŒŒì¼ ìœ í˜•?}
    I -->|ì„ ì •ê²°ê³¼| J{ì ‘ìˆ˜í˜„í™© ì²˜ë¦¬ë¨?}
    J -->|ë¯¸ì²˜ë¦¬| K[ì ‘ìˆ˜í˜„í™© ë¨¼ì € ì²˜ë¦¬]
    J -->|ì™„ë£Œ| L[ì„ ì •ê²°ê³¼ ì²˜ë¦¬]
    I -->|ì ‘ìˆ˜í˜„í™©| M[ì ‘ìˆ˜í˜„í™© ì²˜ë¦¬]
    K --> L
    M --> N{ì„ ì •ê²°ê³¼ íŒŒì¼ ìˆìŒ?}
    N -->|ìˆìŒ| L
    N -->|ì—†ìŒ| O[ì™„ë£Œ ë¦¬í¬íŠ¸]
    L --> O
```

---

## ë‹¨ê³„ë³„ ìƒì„¸ ì„¤ëª…

### Step 1: íŒŒì¼ ì •ë³´ ì¡°íšŒ ë° ê²€ì¦

#### 1.1 íŒŒì¼ ì‹œíŠ¸ì—ì„œ ì¡°íšŒ

```javascript
// íŒŒì¼ ì‹œíŠ¸ì—ì„œ íŒŒì¼ë²ˆí˜¸ë¡œ ê²€ìƒ‰
const files = await sheets.getAllRows('íŒŒì¼');
const file = files.find(f => f['íŒŒì¼ë²ˆí˜¸'] === fileNumber);
```

**í™•ì¸ ì‚¬í•­:**
- íŒŒì¼ ID (FH0001, FH0002 ë“±)
- íŒŒì¼ ìœ í˜• (ì ‘ìˆ˜í˜„í™© / ì„ ì •ê²°ê³¼)
- ì²˜ë¦¬ ìƒíƒœ (ì²˜ë¦¬ì¤‘ / ì™„ë£Œ)
- ì—°ê²°ëœ ì¶œìì‚¬ì—… ID

#### 1.2 ë‹¤ìš´ë¡œë“œ í´ë” ê²€ì¦

```bash
# downloads í´ë”ì—ì„œ ì‹¤ì œ íŒŒì¼ í™•ì¸
ls -la downloads/ | grep -i "${fileNumber}"
```

**ì¤‘ìš”**: íŒŒì¼ ì‹œíŠ¸ì— ì—†ìœ¼ë©´ ì§ì ‘ ë‹¤ìš´ë¡œë“œ í´ë”ì—ì„œ ì°¾ì•„ì„œ ì²˜ë¦¬

#### 1.3 ì¤‘ë³µ ì²´í¬

**íŒŒì¼ë²ˆí˜¸ ì¤‘ë³µ ë¬¸ì œ ì˜ˆì‹œ:**
```text
í–‰2:  ID=FH0001, íŒŒì¼ë²ˆí˜¸=4660, íŒŒì¼ëª…=4116_ì¤‘ê¸°ë¶€...  â† ì˜ëª»ë¨
í–‰201: ID=FH0001, íŒŒì¼ë²ˆí˜¸=4660, íŒŒì¼ëª…=4660_ë¶€ì‚°...  â† ì˜¬ë°”ë¦„
```

**í•´ê²° ë°©ë²•:**
1. íŒŒì¼ëª…ê³¼ íŒŒì¼ë²ˆí˜¸ ì¼ì¹˜ í™•ì¸
2. ë¶ˆì¼ì¹˜ ì‹œ íŒŒì¼ë²ˆí˜¸ ìˆ˜ì •
3. ì¤‘ë³µ IDì¸ ê²½ìš° ìƒˆ ID ë¶€ì—¬

---

### Step 2: ìŒ íŒŒì¼ ê²€ìƒ‰ ë° ì¶œìì‚¬ì—… í™•ì¸

#### 2.1 ì‚¬ì—…ëª… ì¶”ì¶œ

```javascript
// PDF ì½ì–´ì„œ ì‚¬ì—…ëª… ì¶”ì¶œ
const pdfContent = await readPDF(filePath);
const projectName = extractProjectName(pdfContent);
// ì˜ˆ: "ë¶€ì‚° í˜ì‹  ìŠ¤ì¼€ì¼ì—… ë²¤ì²˜í€ë“œ 2025ë…„ ì¶œìì‚¬ì—…"
```

#### 2.2 ë°˜ëŒ€ ìœ í˜• íŒŒì¼ ê²€ìƒ‰

```javascript
const oppositeType = fileType === 'ì ‘ìˆ˜í˜„í™©' ? 'ì„ ì •ê²°ê³¼' : 'ì ‘ìˆ˜í˜„í™©';
const pairFile = files.find(f =>
  f['íŒŒì¼ìœ í˜•'] === oppositeType &&
  matchProjectName(f['íŒŒì¼ëª…'], projectName)
);
```

**ë§¤ì¹­ ì¡°ê±´:**
- ì—°ë„ ì¼ì¹˜ (2024, 2025)
- ì†Œê´€ ì¼ì¹˜ (ì¤‘ê¸°ë¶€, ë¶€ì‚°, ë¬¸ì²´ë¶€)
- ì°¨ìˆ˜ ì¼ì¹˜ (1ì°¨, 2ì°¨, ìˆ˜ì‹œ)
- í‚¤ì›Œë“œ ì¼ì¹˜ (í˜ì‹ , ìŠ¤ì¼€ì¼ì—… ë“±)

#### 2.3 ì¶œìì‚¬ì—… í™•ì¸/ìƒì„±

```javascript
// ê¸°ì¡´ ì¶œìì‚¬ì—… ê²€ìƒ‰
let project = projects.find(p => p['ì‚¬ì—…ëª…'] === projectName);

if (!project) {
  // ì‹ ê·œ ìƒì„±
  project = await sheets.getOrCreateProject(projectName, {
    ì†Œê´€: 'ë¶€ì‚°',
    ê³µê³ ìœ í˜•: 'ì •ì‹œ',
    ì—°ë„: '2025',
    ì°¨ìˆ˜: '1ì°¨'
  });
}
```

**ì¤‘ë³µ ì¶œìì‚¬ì—… ì²˜ë¦¬:**
- ê°™ì€ ì‚¬ì—…ëª…ì´ ì—¬ëŸ¬ ê°œ ìˆìœ¼ë©´ íŒŒì¼ ì—°ê²° ìƒíƒœ í™•ì¸
- ë¹ˆ ì¶œìì‚¬ì—…(ì‹ ì²­í˜„í™© 0ê±´)ì€ ì‚­ì œ ëŒ€ìƒ
- íŒŒì¼ì´ ì´ë¯¸ ì—°ê²°ëœ ì¶œìì‚¬ì—…ì„ ìš°ì„  ì‚¬ìš©

---

### Step 3: íŒŒì¼ ë¶„ì„ (ì´ì¤‘ íŒŒì‹±)

#### 3.1 Claude Code ì§ì ‘ ë¶„ì„

```javascript
// Read ë„êµ¬ë¡œ PDF ì½ê¸°
const pdfContent = await Read(pdfFilePath);

// ìˆ˜ë™ íŒŒì‹±
const claudeResults = parsePDFManually(pdfContent);
// ê²°ê³¼:
// - ìš´ìš©ì‚¬ëª… ëª©ë¡
// - ì¶œìë¶„ì•¼
// - ê¸ˆì•¡ (ê²°ì„±ì˜ˆì •ì•¡, ì¶œììš”ì²­ì•¡)
// - ê³µë™GP ì—¬ë¶€ íŒë‹¨
```

**ì¥ì **:
- PDF êµ¬ì¡°ê°€ ë³µì¡í•´ë„ ì •í™•íˆ ì´í•´
- ê³µë™GP íŒë‹¨ ì •í™•ë„ ë†’ìŒ
- ì…€ ë³‘í•©, íŠ¹ìˆ˜ ë ˆì´ì•„ì›ƒ ì²˜ë¦¬ ê°€ëŠ¥

#### 3.2 pdfplumber íŒŒì‹±

```bash
python3 src/processors/pdf-parser.py "downloads/íŒŒì¼ëª….pdf"
```

**ì¶œë ¥ í˜•ì‹:**
```json
{
  "type": "application",
  "total_funds": 16,
  "total_operators": 20,
  "applications": [
    {
      "category": "ë¼ì´ì½˜",
      "company": "ì–´ë²ˆë°ì¼ë²¤ì²˜ìŠ¤",
      "amount_planned": 51.0,
      "amount_requested": 35.0,
      "is_joint_gp": false
    },
    {
      "category": "AC",
      "company": "ë¶€ì‚°ì°½ì¡°ê²½ì œí˜ì‹ ì„¼í„°",
      "is_joint_gp": true,
      "original_company": "ë¶€ì‚°ì°½ì¡°ê²½ì œí˜ì‹ ì„¼í„°\ní•œêµ­ì‚¬íšŒíˆ¬ì"
    }
  ]
}
```

**ì¥ì **:
- í‘œ êµ¬ì¡° ìë™ ì¸ì‹
- ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„
- ê¸ˆì•¡ í•„ë“œ ìë™ ì¶”ì¶œ

#### 3.3 ê²°ê³¼ ë¹„êµ ë° ë³‘í•©

```javascript
const comparison = compareResults(claudeResults, pdfplumberResults);

// ë¹„êµ ê·œì¹™:
// 1. ì–‘ìª½ ëª¨ë‘ ìˆìŒ â†’ ìš´ìš©ì‚¬ëª…, ë¶„ì•¼ ì¼ì¹˜ í™•ì¸
// 2. Claudeë§Œ ìˆìŒ â†’ í¬í•¨ (ì •í™•ë„ ë†’ìŒ)
// 3. pdfplumberë§Œ ìˆìŒ â†’ ë¬´ì‹œ (ë…¸ì´ì¦ˆ)
// 4. ê³µë™GP íŒë‹¨ ë‹¤ë¦„ â†’ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸
```

**ê³µë™GP ì¶©ëŒ ì²˜ë¦¬:**
```text
pdfplumber: is_joint_gp=true, "A\nB"
Claude: A (ê°œë³„), B (ê°œë³„)

â†’ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸: "PDFì—ì„œ A, Bê°€ ê°™ì€ ì…€ì— ìˆë‚˜ìš”?"
â†’ ë‹µë³€ì— ë”°ë¼ ê³µë™GP ë˜ëŠ” ê°œë³„ë¡œ ì²˜ë¦¬
```

---

### Step 4: ìš´ìš©ì‚¬ ë§¤ì¹­ (ìœ ì‚¬ë„ ê²€ì‚¬)

#### 4.1 ê¸°ì¡´ ìš´ìš©ì‚¬ ì¡°íšŒ

```javascript
const operators = await sheets.getAllOperators();

for (const parsedName of parsedOperators) {
  const matches = findSimilarOperators(parsedName, operators);
  // ë°˜í™˜: [{ id, name, score, coreScore }]
}
```

#### 4.2 ìœ ì‚¬ë„ íŒë‹¨ ë¡œì§

```javascript
function decideSimilarity(parsedName, match) {
  // 1. ì •í™•íˆ ì¼ì¹˜
  if (match.score === 1.0) {
    return { useExisting: true, id: match.id };
  }

  // 2. ë²•ì¸ í‘œê¸° ì°¨ì´ë§Œ
  if (isOnlyLegalDifference(parsedName, match.name)) {
    return { useExisting: true, id: match.id };
  }

  // 3. ìœ ì‚¬ë„ 85% ë¯¸ë§Œ â†’ ì‹ ê·œ
  if (match.score < 0.85) {
    return { createNew: true };
  }

  // 4. ìœ ì‚¬ë„ 85% ì´ìƒ + í•µì‹¬ëª… 60% ë¯¸ë§Œ â†’ ì‹ ê·œ (ì ‘ë¯¸ì‚¬ë§Œ ìœ ì‚¬)
  if (match.score >= 0.85 && match.coreScore < 0.6) {
    return { createNew: true };
  }

  // 5. ìœ ì‚¬ë„ 85% ì´ìƒ + í•µì‹¬ëª… 60% ì´ìƒ â†’ ì‚¬ìš©ì í™•ì¸
  return { askUser: true, match };
}
```

#### 4.3 ìë™ ì²˜ë¦¬ vs ì§ˆë¬¸

**ìë™ ì²˜ë¦¬:**
```text
- "KBì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸" vs "ì¼€ì´ë¹„ì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸" â†’ ê°™ì€ íšŒì‚¬ (ì˜ë¬¸â†”í•œê¸€)
- "ë²¤ì²˜íˆ¬ì" vs "(ì£¼)ë²¤ì²˜íˆ¬ì" â†’ ê°™ì€ íšŒì‚¬ (ë²•ì¸ í‘œê¸°)
- "Aì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸" vs "Bì¸ë² ìŠ¤íŠ¸ë¨¼íŠ¸" â†’ ë‹¤ë¥¸ íšŒì‚¬ (í•µì‹¬ëª… ë‹¤ë¦„)
```

**ì‚¬ìš©ì ì§ˆë¬¸:**
```text
- "ì•„ì´ë¹„ì¼€ì´ìºí”¼íƒˆ" vs "IBKë²¤ì²˜íˆ¬ì"
  â†’ ìœ ì‚¬ë„ 90%, í•µì‹¬ëª… 70% â†’ ì›¹ê²€ìƒ‰ìœ¼ë¡œ í™•ì¸ í•„ìš”
```

---

### Step 5: ë°ì´í„° ì €ì¥

#### 5.1 ì ‘ìˆ˜í˜„í™© íŒŒì¼ ì²˜ë¦¬

**íë¦„:**
```text
1. ì‹ ê·œ ìš´ìš©ì‚¬ ì¼ê´„ ë“±ë¡ (createOperatorsBatch)
2. ê¸°ì¡´ ì‹ ì²­í˜„í™© ì¡°íšŒ (ì¤‘ë³µ ë°©ì§€)
3. ì‹ ì²­í˜„í™© ë°ì´í„° ì¤€ë¹„ (ìƒíƒœ: "ì ‘ìˆ˜")
4. ì¼ê´„ ìƒì„± (createApplicationsBatch)
5. íŒŒì¼ í˜„í™© ì—…ë°ì´íŠ¸
```

**ì½”ë“œ ì˜ˆì‹œ:**
```javascript
// 1. ì‹ ê·œ ìš´ìš©ì‚¬ ì¼ê´„ ë“±ë¡
const newOperators = ['ìš´ìš©ì‚¬A', 'ìš´ìš©ì‚¬B', 'ìš´ìš©ì‚¬C'];
const nameToIdMap = await sheets.createOperatorsBatch(newOperators);
// ë°˜í™˜: Map { 'ìš´ìš©ì‚¬A' => 'OP0500', 'ìš´ìš©ì‚¬B' => 'OP0501', ... }

// 2. ì‹ ì²­í˜„í™© ë°ì´í„° ì¤€ë¹„
const applicationsToCreate = [];
for (const item of parsedData) {
  const operatorId = nameToIdMap.get(item.companyName);
  const key = `${operatorId}|${item.category}`;

  // ì¤‘ë³µ ì²´í¬
  if (existingApps.has(key)) continue;

  applicationsToCreate.push({
    ì¶œìì‚¬ì—…ID: 'PJ0041',
    ìš´ìš©ì‚¬ID: operatorId,
    ì¶œìë¶„ì•¼: item.category,
    ìƒíƒœ: 'ì ‘ìˆ˜',
    ë¹„ê³ : item.isJointGP ? 'ê³µë™GP' : ''
  });
}

// 3. ì¼ê´„ ìƒì„±
const newIds = await sheets.createApplicationsBatch(applicationsToCreate);
console.log(`ì‹ ì²­í˜„í™© ${newIds.length}ê±´ ìƒì„±`);
```

**ì¤‘ë³µ ë°©ì§€ ë¡œì§:**
```javascript
// ì¶œìì‚¬ì—…ID + ìš´ìš©ì‚¬ID + ì¶œìë¶„ì•¼ ì¡°í•©ìœ¼ë¡œ ì¤‘ë³µ ì²´í¬
const existingApps = await sheets.getExistingApplications(projectId);
// ë°˜í™˜: Map { 'OP0001|ì¤‘ì§„-ë£¨í‚¤ë¦¬ê·¸' => { appId: 'AP0001', status: 'ì ‘ìˆ˜' } }

const key = `${operatorId}|${category}`;
if (existingApps.has(key)) {
  console.log('ì¤‘ë³µ ìŠ¤í‚µ:', key);
  continue;
}
```

#### 5.2 ì„ ì •ê²°ê³¼ íŒŒì¼ ì²˜ë¦¬

**íë¦„:**
```text
1. ì¶œìì‚¬ì—…ì˜ ëª¨ë“  ì‹ ì²­í˜„í™© ì¡°íšŒ
2. ì„ ì • ìš´ìš©ì‚¬ ëª©ë¡ ì¶”ì¶œ (PDF íŒŒì‹±)
3. ì„ ì • ì—¬ë¶€ì— ë”°ë¼ ìƒíƒœ ì—…ë°ì´íŠ¸
   - ì„ ì • ëª©ë¡ì— ìˆìŒ â†’ "ì„ ì •"
   - ì„ ì • ëª©ë¡ì— ì—†ìŒ â†’ "íƒˆë½"
4. íŒŒì¼ í˜„í™© ë™ê¸°í™”
```

**ì½”ë“œ ì˜ˆì‹œ:**
```javascript
// 1. ê¸°ì¡´ ì‹ ì²­í˜„í™© ì¡°íšŒ
const apps = await sheets.getAllRows('ì‹ ì²­í˜„í™©');
const projectApps = apps.filter(a => a['ì¶œìì‚¬ì—…ID'] === 'PJ0041');

// 2. ì„ ì • ìš´ìš©ì‚¬ ID ëª©ë¡
const selectedIds = ['AP1568', 'AP1569', 'AP1575', 'AP1576'];

// 3. ìƒíƒœ ì—…ë°ì´íŠ¸
for (const app of projectApps) {
  const newStatus = selectedIds.includes(app['ID']) ? 'ì„ ì •' : 'íƒˆë½';

  if (app['ìƒíƒœ'] !== newStatus) {
    await sheets.setValues(`ì‹ ì²­í˜„í™©!J${app._rowIndex}`, [[newStatus]]);
    console.log(`[${newStatus}] ${app['ID']}`);
  }
}
```

#### 5.3 ì•½ì–´ ìë™ ì—…ë°ì´íŠ¸

**ì‹œë‚˜ë¦¬ì˜¤:**
```text
ì ‘ìˆ˜í˜„í™© PDF: "ì•„ì´ë¹„ì¼€ì´ìºí”¼íƒˆ"
ì„ ì •ê²°ê³¼ PDF: "IBKìºí”¼íƒˆ"

â†’ ìœ ì‚¬ë„ ë§¤ì¹­ìœ¼ë¡œ ê°™ì€ ìš´ìš©ì‚¬ (OP0034)ë¡œ íŒë‹¨
â†’ ì•½ì–´ í•„ë“œì— "ì•„ì´ë¹„ì¼€ì´ìºí”¼íƒˆ", "IBKìºí”¼íƒˆ" ëª¨ë‘ ì¶”ê°€
â†’ ë‹¤ìŒë²ˆ ê²€ìƒ‰ ì‹œ ë‘ í‘œê¸° ëª¨ë‘ ìë™ ë§¤ì¹­ë¨
```

**ì½”ë“œ:**
```javascript
if (matchedOperator && matchedOperator.name !== parsedName) {
  await sheets.updateOperatorAlias(matchedOperator.id, parsedName);
  console.log(`ì•½ì–´ ì¶”ê°€: ${matchedOperator.id} - ${parsedName}`);
}
```

---

### Step 6: í˜„í™© ë™ê¸°í™”

#### 6.1 íŒŒì¼ í˜„í™© ë™ê¸°í™” (CRITICAL)

**âš ï¸ ì ˆëŒ€ íŒŒì‹± ê²°ê³¼ë¡œ ì§ì ‘ ì €ì¥í•˜ì§€ ë§ ê²ƒ!**

```javascript
// âŒ ì˜ëª»ëœ ë°©ë²• (íŒŒì‹± ê²°ê³¼ ì§ì ‘ ì €ì¥)
await sheets.setValues(`íŒŒì¼!I${fileRow}`, [[`ì´ 20ê°œ ì¤‘ ì„ ì • 6ê±´`]]);

// âœ… ì˜¬ë°”ë¥¸ ë°©ë²• (ì‹ ì²­í˜„í™©ì—ì„œ ê³„ì‚°)
await sheets.syncFileStatusWithApplications(fileId);
// â†’ ì‹ ì²­í˜„í™© í…Œì´ë¸”ì—ì„œ ì‹¤ì œ ê±´ìˆ˜ ê³„ì‚°í•˜ì—¬ ì €ì¥
```

**ì´ìœ :**
- íŒŒì‹± ì¤‘ ì¤‘ë³µ ìŠ¤í‚µëœ ê±´ ì œì™¸
- ê³µë™GP ë¶„ë¦¬ë¡œ ê±´ìˆ˜ ì¦ê°€
- ì‹¤ì œ DBì™€ íŒŒì¼ í˜„í™©ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ

**syncFileStatusWithApplications ë¡œì§:**
```javascript
async syncFileStatusWithApplications(fileId) {
  // 1. íŒŒì¼ì´ ì—°ê²°ëœ ì¶œìì‚¬ì—… ì°¾ê¸°
  const projectId = findProjectByFile(fileId);

  // 2. ì¶œìì‚¬ì—…ì˜ ì‹ ì²­í˜„í™© ì¡°íšŒ
  const apps = await getApplicationsByProject(projectId);

  // 3. í†µê³„ ê³„ì‚°
  const total = apps.length;
  const selected = apps.filter(a => a.status === 'ì„ ì •').length;

  // 4. íŒŒì¼ í˜„í™© ì—…ë°ì´íŠ¸
  const status = `ì´ ${total}ê°œ ì¤‘ ì„ ì • ${selected}ê±´`;
  await updateFileStatus(fileId, status);
}
```

#### 6.2 ì¶œìì‚¬ì—… í˜„í™© ì—…ë°ì´íŠ¸

```javascript
await sheets.updateProjectStatus(projectId);
// â†’ "ì´ 20ê±´ (ì„ ì • 6, íƒˆë½ 14)"
```

---

## ì£¼ìš” ì²˜ë¦¬ ë¡œì§

### 1. ê³µë™GP ë¶„ë¦¬ ë¡œì§

**ì…ë ¥:**
```text
"ë¶€ì‚°ì°½ì¡°ê²½ì œí˜ì‹ ì„¼í„°, í•œêµ­ì‚¬íšŒíˆ¬ì"
```

**ì²˜ë¦¬:**
```javascript
const companies = splitJointGP(original);
// ê²°ê³¼: ['ë¶€ì‚°ì°½ì¡°ê²½ì œí˜ì‹ ì„¼í„°', 'í•œêµ­ì‚¬íšŒíˆ¬ì']

// ê°ê° ê°œë³„ ì‹ ì²­í˜„í™© ìƒì„±
for (const company of companies) {
  await createApplication({
    ìš´ìš©ì‚¬ëª…: company,
    ì¶œìë¶„ì•¼: 'AC',
    ë¹„ê³ : 'ê³µë™GP'
  });
}
```

**êµ¬ë¶„ì:**
- `/` (ìŠ¬ë˜ì‹œ)
- `,` (ì‰¼í‘œ)
- `\n` (ì¤„ë°”ê¿ˆ - pdfplumber íŒŒì‹± ì‹œ)

### 2. ê¸ˆì•¡ í•„ë“œ íŒŒì‹±

**ì›í™”:**
```text
"300ì–µì›" â†’ 300 (ìˆ«ì), "ì–µì›" (í†µí™”ë‹¨ìœ„)
"243.35ì–µ" â†’ 243.35, "ì–µì›"
```

**ë‹¬ëŸ¬:**
```text
"USD 50M" â†’ 50, "USD(M)"
"$100M" â†’ 100, "USD(M)"
```

### 3. ì¶œìë¶„ì•¼ í˜•ì‹ í†µì¼

**ì…ë ¥ (PDF):**
```text
"ì¤‘ì§„-ë£¨í‚¤ë¦¬ê·¸"
"ì¤‘ì§„ ë£¨í‚¤ë¦¬ê·¸"
"ì²­ë…„/ì²­ë…„ì°½ì—…"
```

**ì¶œë ¥ (DB):**
```text
"ì¤‘ì§„ - ë£¨í‚¤ë¦¬ê·¸"
"ì²­ë…„ - ì²­ë…„ì°½ì—…"
```

**ì •ê·œí™” ê·œì¹™:**
- ê³„ì •ê³¼ ë¶„ì•¼ ì‚¬ì´: ` - ` (ê³µë°±-ëŒ€ì‹œ-ê³µë°±)
- ìŠ¬ë˜ì‹œ/í•˜ì´í”ˆ â†’ ëŒ€ì‹œë¡œ í†µì¼

---

## ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬

### 1. íŒŒì¼ë²ˆí˜¸ ì¤‘ë³µ

**ìƒí™©:**
```text
FH0001: íŒŒì¼ë²ˆí˜¸=4660, íŒŒì¼ëª…=4116_ì¤‘ê¸°ë¶€...  â† ì˜¤ë¥˜
FH0001: íŒŒì¼ë²ˆí˜¸=4660, íŒŒì¼ëª…=4660_ë¶€ì‚°...    â† ì˜¤ë¥˜
```

**í•´ê²°:**
```javascript
// 1. íŒŒì¼ëª…ì—ì„œ ì‹¤ì œ íŒŒì¼ë²ˆí˜¸ ì¶”ì¶œ
const actualNumber = extractFileNumber(fileName);

// 2. ë¶ˆì¼ì¹˜ ì‹œ ìˆ˜ì •
if (fileNumber !== actualNumber) {
  await sheets.setValues(`íŒŒì¼!C${row}`, [[actualNumber]]);
}

// 3. ì¤‘ë³µ ID ìˆ˜ì •
const lastId = getLastFileId(); // FH0119
const newId = incrementId(lastId); // FH0120
await sheets.setValues(`íŒŒì¼!A${row}`, [[newId]]);
```

### 2. ì¤‘ë³µ ì¶œìì‚¬ì—…

**ìƒí™©:**
```text
PJ0041: ë¶€ì‚° í˜ì‹  ìŠ¤ì¼€ì¼ì—… ë²¤ì²˜í€ë“œ 2025ë…„ ì¶œìì‚¬ì—… (ì‹ ì²­í˜„í™© 20ê±´)
PJ0045: ë¶€ì‚° í˜ì‹  ìŠ¤ì¼€ì¼ì—… ë²¤ì²˜í€ë“œ 2025ë…„ (ì‹ ì²­í˜„í™© 0ê±´) â† ì¤‘ë³µ
```

**í•´ê²°:**
```javascript
// 1. ì‹ ì²­í˜„í™© 0ê±´ì¸ ì¶œìì‚¬ì—… ì°¾ê¸°
const emptyProject = projects.find(p =>
  p.name === targetName &&
  getApplicationCount(p.id) === 0
);

// 2. ì‚­ì œ
if (emptyProject) {
  await sheets.deleteRow('ì¶œìì‚¬ì—…', emptyProject._rowIndex);
  console.log(`ì¤‘ë³µ ì¶œìì‚¬ì—… ì‚­ì œ: ${emptyProject.id}`);
}
```

### 3. íŒŒì¼ ì¤‘ë³µ ì—°ê²° ì˜¤ë¥˜

**ì˜¤ë¥˜ ë©”ì‹œì§€:**
```text
Error: íŒŒì¼ ì¤‘ë³µ ì—°ê²° ì˜¤ë¥˜: FH0074ëŠ” ì´ë¯¸ PJ0041ì— ì—°ê²°ë¨.
í˜„ì¬ ì‹œë„: PJ0045
```

**ì›ì¸:**
- ì¤‘ë³µ ì¶œìì‚¬ì—…ì— íŒŒì¼ ì—°ê²° ì‹œë„
- íŒŒì¼-ì¶œìì‚¬ì—… ë§¤ì¹­ ì˜¤ë¥˜

**í•´ê²°:**
```javascript
// 1. ê¸°ì¡´ ì—°ê²° í™•ì¸
const linkedProject = findProjectByFile(fileId);

// 2. ê¸°ì¡´ ì¶œìì‚¬ì—… ì‚¬ìš©
if (linkedProject) {
  console.log(`íŒŒì¼ì´ ì´ë¯¸ ${linkedProject.id}ì— ì—°ê²°ë¨`);
  projectId = linkedProject.id; // ê¸°ì¡´ ì¶œìì‚¬ì—… ì‚¬ìš©
}
```

### 4. API í• ë‹¹ëŸ‰ ì´ˆê³¼

**ì¦ìƒ:**
```text
Error: Quota exceeded for quota metric 'Read requests' and limit...
```

**ìë™ ì¬ì‹œë„:**
```javascript
async function retryWithBackoff(fn, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      return await fn();
    } catch (err) {
      if (err.code === 429 && i < maxRetries - 1) {
        console.log(`API í• ë‹¹ëŸ‰ ì´ˆê³¼, 60ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„ (${i+1}/${maxRetries})`);
        await sleep(60000);
      } else {
        throw err;
      }
    }
  }
}
```

---

## ì‹¤ì œ ì²˜ë¦¬ ì˜ˆì‹œ

### ì˜ˆì‹œ 1: ì ‘ìˆ˜í˜„í™© + ì„ ì •ê²°ê³¼ ì—°ì† ì²˜ë¦¬

**ëª…ë ¹:**
```bash
/update 4660
```

**ì‹¤í–‰ ê³¼ì •:**

```text
[1] íŒŒì¼ ì •ë³´ ì¡°íšŒ
    - íŒŒì¼ë²ˆí˜¸: 4660
    - íŒŒì¼ëª…: ë¶€ì‚°_í˜ì‹ _ìŠ¤ì¼€ì¼ì—…_ë²¤ì²˜í€ë“œ_2025ë…„_ì„ ì •_ê²°ê³¼.pdf
    - íŒŒì¼ ìœ í˜•: ì„ ì •ê²°ê³¼

[2] ìŒ íŒŒì¼ ê²€ìƒ‰
    - ì ‘ìˆ˜í˜„í™© íŒŒì¼ ê²€ìƒ‰: 4616 ë°œê²¬
    - ìƒíƒœ í™•ì¸: ì™„ë£Œ âœ“

[3] ì¶œìì‚¬ì—… í™•ì¸
    - íŒŒì¼ 4616ì´ PJ0041ì— ì—°ê²°ë¨
    - PJ0041 ì‚¬ìš©

[4] ì„ ì •ê²°ê³¼ íŒŒì¼ ë¶„ì„
    - Claude ë¶„ì„: 6ê°œ ìš´ìš©ì‚¬ ì„ ì •
    - pdfplumber íŒŒì‹±: 8ê°œ í•­ëª© (ë…¸ì´ì¦ˆ 2ê°œ)
    - ë¹„êµ í›„ 6ê°œ í™•ì •

[5] ìš´ìš©ì‚¬ ë§¤ì¹­
    - ë¶€ì‚°ì°½ì¡°ê²½ì œí˜ì‹ ì„¼í„° â†’ OP0355 (ê¸°ì¡´)
    - í•œêµ­ì‚¬íšŒíˆ¬ì â†’ OP0127 (ê¸°ì¡´)
    - ì œí”¼ëŸ¬ìŠ¤ë© â†’ OP0134 (ê¸°ì¡´)
    - ë¹„ì—”ì¼€ì´ë²¤ì²˜íˆ¬ì â†’ OP0472 (ê¸°ì¡´)
    - ë‚˜ìš°ì•„ì´ë¹„ìºí”¼íƒˆ â†’ OP0002 (ê¸°ì¡´)
    - ì¸ë¼ì´íŠ¸ë²¤ì²˜ìŠ¤ â†’ OP0087 (ê¸°ì¡´)

[6] ìƒíƒœ ì—…ë°ì´íŠ¸
    - PJ0041 ì‹ ì²­í˜„í™© 20ê±´ ì¡°íšŒ
    - ì„ ì • 6ê±´ â†’ "ì„ ì •"
    - ë‚˜ë¨¸ì§€ 14ê±´ â†’ "íƒˆë½"

[7] í˜„í™© ë™ê¸°í™”
    - íŒŒì¼ FH0120: "ì´ 20ê°œ ì¤‘ ì„ ì • 6ê±´"
    - ì¶œìì‚¬ì—… PJ0041: "ì´ 20ê±´ (ì„ ì • 6, íƒˆë½ 14)"

[8] ì™„ë£Œ
    âœ… ì„ ì • 6ê±´ ì—…ë°ì´íŠ¸
    âœ… íƒˆë½ 14ê±´ ì—…ë°ì´íŠ¸
```

### ì˜ˆì‹œ 2: ì ‘ìˆ˜í˜„í™© ì²˜ë¦¬ (ì„ ì •ê²°ê³¼ ë¯¸ì²˜ë¦¬)

**ëª…ë ¹:**
```bash
/update 4616
```

**ì‹¤í–‰ ê³¼ì •:**

```text
[1] íŒŒì¼ ì •ë³´ ì¡°íšŒ
    - íŒŒì¼ë²ˆí˜¸: 4616
    - íŒŒì¼ ìœ í˜•: ì ‘ìˆ˜í˜„í™©
    - ì²˜ë¦¬ìƒíƒœ: ë¯¸ì²˜ë¦¬

[2] ì¶œìì‚¬ì—… ìƒì„±
    - ì‚¬ì—…ëª…: ë¶€ì‚° í˜ì‹  ìŠ¤ì¼€ì¼ì—… ë²¤ì²˜í€ë“œ 2025ë…„ ì¶œìì‚¬ì—…
    - PJ0041 ìƒì„±

[3] íŒŒì¼ ë¶„ì„
    - ì‹ ì²­ì¡°í•© 16ê°œ
    - ê³µë™GP 4ê±´ â†’ 20ê°œ ì‹ ì²­í˜„í™©ìœ¼ë¡œ ë¶„ë¦¬

[4] ìš´ìš©ì‚¬ ë§¤ì¹­
    - ê¸°ì¡´ ìš´ìš©ì‚¬ 13ê°œ
    - ì‹ ê·œ ìš´ìš©ì‚¬ 7ê°œ ë“±ë¡

[5] ì‹ ì²­í˜„í™© ìƒì„±
    - 20ê±´ ì¼ê´„ ìƒì„± (ìƒíƒœ: "ì ‘ìˆ˜")
    - AP1567 ~ AP1586

[6] ìŒ íŒŒì¼ ê²€ìƒ‰
    - ì„ ì •ê²°ê³¼ íŒŒì¼ ì—†ìŒ
    - ì ‘ìˆ˜í˜„í™©ë§Œ ì²˜ë¦¬ ì™„ë£Œ

[7] í˜„í™© ì—…ë°ì´íŠ¸
    - íŒŒì¼ FH0074: "ì‹ ì²­ì¡°í•© 16ê°œ, ì´ ì‹ ì²­í˜„í™© 20ê±´"
    - ì¶œìì‚¬ì—… PJ0041: "ì´ 20ê±´"

[8] ì™„ë£Œ
    âœ… ì‹ ì²­í˜„í™© 20ê±´ ìƒì„±
    âœ… ì‹ ê·œ ìš´ìš©ì‚¬ 7ê°œ ë“±ë¡
```

---

## í•µì‹¬ í¬ì¸íŠ¸ ìš”ì•½

### âœ… ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•  ê²ƒ

1. **ì ‘ìˆ˜í˜„í™© ë¨¼ì €, ì„ ì •ê²°ê³¼ëŠ” ë‚˜ì¤‘ì—**
   - ì„ ì •ê²°ê³¼ ì²˜ë¦¬ ì „ ë°˜ë“œì‹œ ì ‘ìˆ˜í˜„í™©ì´ ìˆì–´ì•¼ í•¨

2. **ìŒ íŒŒì¼ ìë™ ì—°ì† ì²˜ë¦¬**
   - ì ‘ìˆ˜í˜„í™© ì²˜ë¦¬ í›„ ì„ ì •ê²°ê³¼ íŒŒì¼ì´ ìˆìœ¼ë©´ ë°”ë¡œ ì²˜ë¦¬
   - ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸í•˜ì§€ ë§ê³  ìë™ ì§„í–‰

3. **íŒŒì¼ í˜„í™©ì€ ì‹ ì²­í˜„í™©ì—ì„œ ê³„ì‚°**
   - íŒŒì‹± ê²°ê³¼ë¥¼ ì§ì ‘ ì €ì¥í•˜ì§€ ë§ ê²ƒ
   - `syncFileStatusWithApplications()` ì‚¬ìš©

4. **ì¤‘ë³µ ë°©ì§€**
   - ì¶œìì‚¬ì—…ID + ìš´ìš©ì‚¬ID + ì¶œìë¶„ì•¼ ì¡°í•©ìœ¼ë¡œ ì²´í¬
   - ì¤‘ë³µì´ë©´ ìŠ¤í‚µ, ê±´ìˆ˜ì— í¬í•¨í•˜ì§€ ì•ŠìŒ

### âš ï¸ ì£¼ì˜í•´ì•¼ í•  ê²ƒ

1. **íŒŒì¼ë²ˆí˜¸-íŒŒì¼ëª… ë¶ˆì¼ì¹˜**
   - ë°˜ë“œì‹œ íŒŒì¼ëª…ì—ì„œ ì‹¤ì œ ë²ˆí˜¸ ì¶”ì¶œí•˜ì—¬ ê²€ì¦

2. **ê³µë™GP íŒë‹¨ ì¶©ëŒ**
   - pdfplumberì™€ Claude ê²°ê³¼ê°€ ë‹¤ë¥´ë©´ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸

3. **ìœ ì‚¬ ìš´ìš©ì‚¬ ì²˜ë¦¬**
   - ìœ ì‚¬ë„ 85% ì´ìƒ + í•µì‹¬ëª… 60% ì´ìƒë§Œ ì§ˆë¬¸
   - ë‚˜ë¨¸ì§€ëŠ” ìë™ íŒë‹¨

4. **API í• ë‹¹ëŸ‰**
   - ë°°ì¹˜ ì²˜ë¦¬ ìš°ì„  ì‚¬ìš©
   - ì´ˆê³¼ ì‹œ ìë™ ì¬ì‹œë„ (ìµœëŒ€ 3íšŒ)

---

## ì°¸ê³  íŒŒì¼

- [.claude/commands/update.md](.claude/commands/update.md) - ëª…ë ¹ì–´ ìŠ¤í™
- [CLAUDE.md](CLAUDE.md) - í”„ë¡œì íŠ¸ ì „ì²´ ê°€ì´ë“œ
- [src/processors/process-pair-sheets.js](src/processors/process-pair-sheets.js) - ì‹¤ì œ ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸
- [src/core/googleSheets.js](src/core/googleSheets.js) - Google Sheets API í´ë¼ì´ì–¸íŠ¸
- [src/matchers/operator-matcher.js](src/matchers/operator-matcher.js) - ìš´ìš©ì‚¬ ìœ ì‚¬ë„ ë§¤ì¹­ ë¡œì§