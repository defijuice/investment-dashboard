# PDF/HWP íŒŒì¼ ì²˜ë¦¬ ë° Google Sheets ì—…ë°ì´íŠ¸

ì…ë ¥ë°›ì€ íŒŒì¼ë²ˆí˜¸ì˜ íŒŒì¼ì„ ë¶„ì„í•˜ì—¬ Google Sheetsì— ì €ì¥í•©ë‹ˆë‹¤.

> **ì´ ë¬¸ì„œê°€ `/update` ëª…ë ¹ì–´ì˜ ë©”ì¸ ë ˆí¼ëŸ°ìŠ¤ì…ë‹ˆë‹¤.**
> `/parse` + `/save`ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ëŠ” í†µí•© ì»¤ë§¨ë“œì…ë‹ˆë‹¤.

## í•µì‹¬ ì›ì¹™: ë‹¨ê³„ë³„ ì²˜ë¦¬

**ì ‘ìˆ˜í˜„í™©ê³¼ ì„ ì •ê²°ê³¼ëŠ” ë°˜ë“œì‹œ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.**

1. **ì ‘ìˆ˜í˜„í™© íŒŒì¼ ì²˜ë¦¬** â†’ ëª¨ë“  ì‹ ì²­í˜„í™©ì„ **"ì ‘ìˆ˜"** ìƒíƒœë¡œ ì €ì¥
2. **ì„ ì •ê²°ê³¼ íŒŒì¼ ì²˜ë¦¬** â†’ ì„ ì •ëœ ìš´ìš©ì‚¬ëŠ” **"ì„ ì •"**, ë‚˜ë¨¸ì§€ëŠ” **"íƒˆë½"**ìœ¼ë¡œ ì—…ë°ì´íŠ¸

## ì…ë ¥ íŒŒë¼ë¯¸í„°

- **íŒŒì¼ë²ˆí˜¸**: $ARGUMENTS (ê³µë°±ìœ¼ë¡œ êµ¬ë¶„ëœ ì—¬ëŸ¬ ê°œ ê°€ëŠ¥)

ì˜ˆì‹œ:
```bash
/update 4524           # ë‹¨ì¼ íŒŒì¼
/update 4524 4525      # ì ‘ìˆ˜+ì„ ì • ìŒ
```

---

## ì²˜ë¦¬ íë¦„

### ìë™ ìŒ íŒŒì¼ ê°ì§€

ë‹¨ì¼ íŒŒì¼ë²ˆí˜¸ ì…ë ¥ ì‹œ:
1. íŒŒì¼ ìœ í˜• í™•ì¸ (ì ‘ìˆ˜í˜„í™©/ì„ ì •ê²°ê³¼)
2. ê°™ì€ ì‚¬ì—…ì˜ ë°˜ëŒ€ ìœ í˜• íŒŒì¼ ìë™ ê²€ìƒ‰
3. ìŒ íŒŒì¼ ì¡´ì¬ ì‹œ í•¨ê»˜ ì²˜ë¦¬

```text
/update 4524 ì‹¤í–‰ ì‹œ:
  1. 4524 (ì ‘ìˆ˜í˜„í™©) íŒŒì¼ í™•ì¸
  2. ê°™ì€ ì‚¬ì—…ì˜ ì„ ì •ê²°ê³¼ íŒŒì¼ ê²€ìƒ‰ â†’ 4525 ë°œê²¬
  3. 4524 + 4525 í•¨ê»˜ ì²˜ë¦¬
```

### Step 1: íŒŒì‹± (ë³‘ë ¬)

```text
/parse {íŒŒì¼ë²ˆí˜¸ë“¤}
```

ë‚´ë¶€ì ìœ¼ë¡œ ì„œë¸Œì—ì´ì „íŠ¸ê°€ ë³‘ë ¬ ì‹¤í–‰:
- ì ‘ìˆ˜í˜„í™© íŒŒì¼ â†’ receipt-parser ì—ì´ì „íŠ¸
- ì„ ì •ê²°ê³¼ íŒŒì¼ â†’ selection-parser ì—ì´ì „íŠ¸

**ìºì‹œ ìƒì„±:**
- `result/{íŒŒì¼ë²ˆí˜¸}_receipt.json`
- `result/{íŒŒì¼ë²ˆí˜¸}_selection.json`

### Step 2: ì €ì¥

```text
/save {íŒŒì¼ë²ˆí˜¸ë“¤}
```

ìºì‹œì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ Google Sheetsì— ì €ì¥:
1. ìœ ì‚¬ ìš´ìš©ì‚¬ í™•ì¸ (í•„ìš”ì‹œë§Œ ì§ˆë¬¸)
2. ì¶œìì‚¬ì—… í™•ì¸/ìƒì„±
3. ìš´ìš©ì‚¬ ë°°ì¹˜ ìƒì„±
4. ì‹ ì²­í˜„í™© ë°°ì¹˜ ìƒì„±
5. ì„ ì •/íƒˆë½ íŒì •
6. í˜„í™© ì—…ë°ì´íŠ¸

---

## ì‹¤í–‰ ëª¨ë“œ: ìë™ ì§„í–‰ (Auto Mode)

**ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ì í™•ì¸ ì—†ì´ ìë™ ì§„í–‰í•©ë‹ˆë‹¤.** ë‹¤ìŒ ê²½ìš°ì—ë§Œ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸:

1. **ìœ ì‚¬ë„ 85% ì´ìƒ + í•µì‹¬ëª… 60% ì´ìƒ ìš´ìš©ì‚¬** - ë™ì¼ íšŒì‚¬ ì—¬ë¶€ íŒë‹¨ ë¶ˆê°€ ì‹œ
2. **ê³µë™GP íŒë‹¨ì´ ë‹¤ë¥¼ ë•Œ** - pdfplumberì™€ Claude ë¶„ì„ ê²°ê³¼ê°€ ë‹¤ë¥´ë©´

### ìë™ ì²˜ë¦¬ ê·œì¹™

| ìƒí™© | ìë™ ì²˜ë¦¬ ë°©ì‹ |
|------|---------------|
| ìš´ìš©ì‚¬ ìˆ˜ ì¼ì¹˜ | ìë™ ì§„í–‰ |
| pdfplumberì—ë§Œ ìˆëŠ” í•­ëª© | ë¬´ì‹œ (ë…¸ì´ì¦ˆë¡œ ê°„ì£¼) |
| Claudeì—ë§Œ ìˆëŠ” í•­ëª© | í¬í•¨ (ì •í™•ë„ ë†’ìŒ) |
| ìœ ì‚¬ ìš´ìš©ì‚¬ (85% ë¯¸ë§Œ) | ì‹ ê·œ ë“±ë¡ |
| ìœ ì‚¬ ìš´ìš©ì‚¬ (85% ì´ìƒ + í•µì‹¬ëª… 60% ë¯¸ë§Œ) | ì‹ ê·œ ë“±ë¡ |
| ìœ ì‚¬ ìš´ìš©ì‚¬ (85% ì´ìƒ + í•µì‹¬ëª… 60% ì´ìƒ) | ì‚¬ìš©ì í™•ì¸ |
| (ì£¼), ì£¼ì‹íšŒì‚¬ ë“± ë²•ì¸ í‘œê¸° | ê¸°ì¡´ ìš´ìš©ì‚¬ì™€ ë™ì¼ ì²˜ë¦¬ |

---

## ì§€ì› íŒŒì¼ í˜•ì‹

### PDF íŒŒì¼
- Read ë„êµ¬ë¡œ ì§ì ‘ ë¶„ì„
- pdfplumber íŒŒì‹± (ë¹„êµìš©)
- ë‘ ê²°ê³¼ ë¹„êµ í›„ Claude ìš°ì„ 

### HWP íŒŒì¼
- Playwright MCPë¡œ Google Drive ë·°ì–´ì—ì„œ ìº¡ì²˜
- ìº¡ì²˜ ì´ë¯¸ì§€ OCR ë¶„ì„

**HWP ìº¡ì²˜ ì ˆì°¨:**
```text
1. browser_navigate â†’ Google Drive íŒŒì¼ URL
2. browser_wait_for â†’ 3ì´ˆ ëŒ€ê¸°
3. browser_snapshot â†’ ì´ í˜ì´ì§€ ìˆ˜ í™•ì¸
4. ê° í˜ì´ì§€ ìº¡ì²˜ (ìƒë‹¨/í•˜ë‹¨)
5. Read â†’ ìº¡ì²˜ ì´ë¯¸ì§€ ë¶„ì„
6. browser_close
```

---

## ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ìš”ì•½

### ê³µë™GP ì²˜ë¦¬
- êµ¬ë¶„ì: ì¤„ë°”ê¿ˆ > ì‰¼í‘œ > ìŠ¬ë˜ì‹œ
- ê°œë³„ í–‰ìœ¼ë¡œ ë¶„ë¦¬
- ì„ ì •ê²°ê³¼: ê¸ˆì•¡ Në¹µ ì ìš©

### ìš´ìš©ì‚¬ ìœ ì‚¬ë„
- 9ë‹¨ê³„ ìœ ì‚¬ë„ ì•Œê³ ë¦¬ì¦˜
- ì˜ë¬¸â†”í•œê¸€ ì–‘ë°©í–¥ ë§¤ì¹­ (KB â†” ì¼€ì´ë¹„)
- ì ‘ë¯¸ì‚¬ ì œê±° í›„ í•µì‹¬ëª… ë¹„êµ

### ê¸ˆì•¡ í˜•ì‹
- ì–µì›/M ë‹¨ìœ„ ìˆ«ìë¡œ ì €ì¥
- USD ê°ì§€ ì‹œ í™˜ìœ¨ ë³€í™˜

### í˜„í™© ì—…ë°ì´íŠ¸
- íŒŒì¼ í˜„í™©: ì‹ ì²­í˜„í™© í…Œì´ë¸”ì—ì„œ ê³„ì‚°
- ì¶œìì‚¬ì—… í˜„í™©: "ì´ Nê±´ (ì„ ì • X, íƒˆë½ Y)"

---

## ì¶œë ¥ í˜•ì‹

```text
ğŸ“„ /update 4524 4525 ì‹¤í–‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[Step 1] íŒŒì‹± (ë³‘ë ¬)

  [FH4524] ì ‘ìˆ˜í˜„í™©
    - íŒŒì‹± ê±´ìˆ˜: 171ê±´
    - ê³µë™GP: 12ê°œ â†’ ë¶„ë¦¬ í›„ 165ê±´
    - ìºì‹œ: result/4524_receipt.json âœ“

  [FH4525] ì„ ì •ê²°ê³¼
    - íŒŒì‹± ê±´ìˆ˜: 45ê±´
    - USD í™˜ìœ¨: 1,320.5ì›
    - ìºì‹œ: result/4525_selection.json âœ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[Step 2] ì €ì¥

  ì¶œìì‚¬ì—…: PJ0045 (ì¤‘ê¸°ë¶€ 2025ë…„ 1ì°¨ ì •ì‹œ)

  [FH4524] ì ‘ìˆ˜í˜„í™© ì €ì¥
    - ì‹ ê·œ ìš´ìš©ì‚¬: 40ê°œ
    - ì‹ ì²­í˜„í™©: 165ê±´ ìƒì„±
    - íŒŒì¼ í˜„í™© ì—…ë°ì´íŠ¸ âœ“

  [FH4525] ì„ ì •ê²°ê³¼ ì €ì¥
    - ì„ ì •: 45ê±´
    - íƒˆë½: 120ê±´
    - íŒŒì¼ í˜„í™© ì—…ë°ì´íŠ¸ âœ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… ì™„ë£Œ

ì¶œìì‚¬ì—… í˜„í™©: ì´ 165ê±´ (ì„ ì • 45, íƒˆë½ 120)

ìŠ¤í”„ë ˆë“œì‹œíŠ¸: https://docs.google.com/spreadsheets/d/...
```

---

## ì—ëŸ¬ ì²˜ë¦¬

### ìºì‹œ íŒŒì¼ ì—†ìŒ (íŒŒì‹± ì‹¤íŒ¨)
```text
âŒ íŒŒì‹± ì‹¤íŒ¨: íŒŒì¼ë²ˆí˜¸ 4524
   â†’ PDF íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ íŒŒì‹±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
```

### API í• ë‹¹ëŸ‰ ì´ˆê³¼
```text
âš ï¸ API í• ë‹¹ëŸ‰ ì´ˆê³¼
   1ë¶„ ëŒ€ê¸° í›„ ìë™ ì¬ì‹œë„... (1/3)
```

### ì¤‘ë³µ íŒŒì¼ ì—°ê²°
```text
âŒ íŒŒì¼ ì¤‘ë³µ ì—°ê²° ì˜¤ë¥˜
   FH0044ëŠ” ì´ë¯¸ PJ0021ì— ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
```

---

## ê´€ë ¨ ì»¤ë§¨ë“œ

| ì»¤ë§¨ë“œ | ì—­í•  |
|--------|------|
| `/parse {íŒŒì¼ë²ˆí˜¸ë“¤}` | PDF íŒŒì‹±ë§Œ (ìºì‹œ ìƒì„±) |
| `/save {íŒŒì¼ë²ˆí˜¸ë“¤}` | ìºì‹œ â†’ Sheets ì €ì¥ |
| `/update {íŒŒì¼ë²ˆí˜¸ë“¤}` | parse + save í†µí•© |
| `/verify {ì¶œìì‚¬ì—…ID}` | ë°ì´í„° ì •í•©ì„± ê²€ì¦ |

## ìƒì„¸ ê·œì¹™ ì°¸ì¡°

- **ì‹œíŠ¸ êµ¬ì¡°**: CLAUDE.md
- **ê³µë™GP ì²˜ë¦¬**: CLAUDE.md > ê³µë™GP ì²˜ë¦¬
- **ìš´ìš©ì‚¬ ë§¤ì¹­**: CLAUDE.md > ìš´ìš©ì‚¬ ë§¤ì¹­ ê·œì¹™
- **ê¸ˆì•¡ í˜•ì‹**: CLAUDE.md > ê¸ˆì•¡ í•„ë“œ í˜•ì‹
- **íŒŒì‹± ìƒì„¸**: `.claude/agents/receipt-parser.md`, `.claude/agents/selection-parser.md`
- **ì €ì¥ ìƒì„¸**: `.claude/commands/save.md`
